---
phase: 02-bot-marketplace
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/dialogs/CreateBotWizard/steps/MethodSelectStep.tsx
autonomous: false
requirements:
  - MKTB-01
  - MKTB-02
  - MKTB-03

must_haves:
  truths:
    - "Bot creation wizard shows a 'Browse Templates' card alongside 'AI Assisted', 'Start Blank', and 'Import'"
    - "Clicking 'Browse Templates' opens the MarketplaceBrowser dialog with categories, search, and previews"
    - "Installing a template from the MarketplaceBrowser closes the wizard and the new bot becomes active"
    - "The 'Popular from Marketplace' mini-preview section still appears below the method cards for quick discovery"
  artifacts:
    - path: "frontend/src/components/dialogs/CreateBotWizard/steps/MethodSelectStep.tsx"
      provides: "Browse Templates method card in the methods grid"
      contains: "Browse Templates"
  key_links:
    - from: "MethodSelectStep.tsx Browse Templates card"
      to: "MarketplaceBrowser dialog"
      via: "setMarketplaceOpen(true) on click"
      pattern: "onClick.*setMarketplaceOpen\\(true\\)"
    - from: "MarketplaceBrowser onInstalled"
      to: "handleMarketplaceInstalled"
      via: "callback that calls close() + reset()"
      pattern: "onInstalled.*handleMarketplaceInstalled"
---

<objective>
Add a "Browse Templates" method card to the bot creation wizard so it appears as a first-class option alongside "AI Assisted", "Start Blank", and "Import".

Purpose: MKTB-03 requires "Browse Templates" as a primary creation method, not just a supplementary section. The entire marketplace infrastructure (MarketplaceBrowser, BotDetailPanel, installMarketplaceTemplate, backend endpoint) already exists and is fully wired. This plan elevates the entry point from a mini-preview section to a method card.

Output: Updated MethodSelectStep.tsx with "Browse Templates" card in the methods grid.
</objective>

<execution_context>
@/home/uan/.claude/get-shit-done/workflows/execute-plan.md
@/home/uan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-bot-marketplace/02-RESEARCH.md
@frontend/src/components/dialogs/CreateBotWizard/steps/MethodSelectStep.tsx
@frontend/src/stores/creation.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Browse Templates method card to MethodSelectStep grid</name>
  <files>frontend/src/components/dialogs/CreateBotWizard/steps/MethodSelectStep.tsx</files>
  <action>
In MethodSelectStep.tsx, add a "Browse Templates" card to the secondary methods grid (the `grid-cols-2` div that currently holds "Start Blank" and "Import").

**Changes to make:**

1. Expand the secondary grid from `grid-cols-2` to `grid-cols-3` so it holds "Start Blank", "Import", and "Browse Templates" side by side. The grid is at approximately line 117: `<div className="grid grid-cols-2 gap-3">`.

2. After the `.map()` block that renders "Start Blank" and "Import" (after line 145's closing `})`), add a "Browse Templates" card INSIDE the same grid div. This card must NOT call `handleSelect()` — it opens the marketplace dialog instead. Use:

```tsx
<button
  onClick={() => setMarketplaceOpen(true)}
  className={cn(
    'relative flex items-center gap-3 rounded-xl border p-4 text-left transition-all',
    'border-[var(--color-border-primary)] bg-[var(--card-bg)] hover:border-[var(--color-border-secondary)] hover:bg-[var(--color-hover-bg)]'
  )}
>
  <div
    className="flex h-10 w-10 shrink-0 items-center justify-center rounded-xl"
    style={{ backgroundColor: '#3b82f620' }}
  >
    <Store className="h-5 w-5" style={{ color: '#3b82f6' }} />
  </div>
  <div>
    <h3 className="text-sm font-semibold text-[var(--color-text-primary)]">Browse Templates</h3>
    <p className="text-xs text-[var(--color-text-secondary)]">Pick from curated bot templates</p>
  </div>
</button>
```

**IMPORTANT anti-patterns to avoid:**
- Do NOT add `'marketplace'` to the `WizardMethod` type or `STEP_FLOWS` — it would break wizard step resolution. "Browse Templates" opens a dialog, not a wizard step sequence.
- Do NOT remove the existing "Popular from Marketplace" mini-preview section — it provides passive discovery value and should remain below the method cards.
- Do NOT duplicate install logic — `BotDetailPanel.handleInstall()` already handles `addBot()` + `setActiveBot()`.
- The `Store` icon is already imported from lucide-react (line 2).

3. Keep the "Popular from Marketplace" mini-preview section exactly as-is below the methods grid. It remains a secondary discovery surface.
  </action>
  <verify>
Run `cd /mnt/c/Users/Juan/Documents/GitHub/CachiBot/frontend && npx tsc --noEmit` to verify no TypeScript errors. Grep MethodSelectStep.tsx for "Browse Templates" to confirm the card exists. Grep for "grid-cols-3" to confirm the grid was expanded. Verify `WizardMethod` type in creation.ts was NOT modified (should still be `'ai-assisted' | 'blank' | 'import'`).
  </verify>
  <done>
MethodSelectStep renders four method options: "AI Assisted" (full-width primary), "Start Blank", "Import", and "Browse Templates" (in a 3-column grid). Clicking "Browse Templates" opens MarketplaceBrowser. The mini-preview section remains below. No changes to WizardMethod or STEP_FLOWS.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify Browse Templates card and full install flow</name>
  <files>frontend/src/components/dialogs/CreateBotWizard/steps/MethodSelectStep.tsx</files>
  <action>
Human verification checkpoint. What was built: "Browse Templates" method card added to the bot creation wizard alongside "AI Assisted", "Start Blank", and "Import". The full marketplace install flow (browse, preview, install, wizard closes, bot active) uses existing infrastructure unchanged.

Steps to verify:
1. Start the frontend dev server: `cd frontend && npm run dev`
2. Open http://localhost:5173 in a browser
3. Click the "Create Bot" button to open the wizard
4. Verify the method selection step shows:
   - "AI Assisted" as a full-width primary card (with "Recommended" badge)
   - "Start Blank", "Import", and "Browse Templates" as three cards in a row below
5. Verify "Browse Templates" has a blue Store icon and description "Pick from curated bot templates"
6. Click "Browse Templates" — verify the MarketplaceBrowser dialog opens with categories sidebar, search, and template cards
7. Click a template card — verify BotDetailPanel opens showing template details and an "Install Template" button
8. Click "Install Template" — verify:
   - The MarketplaceBrowser closes
   - The wizard closes
   - The newly installed bot becomes the active bot in the sidebar
9. Verify the "Popular from Marketplace" mini-preview section still appears below the method cards
10. Test at different dialog widths — verify the 3-column grid does not break or truncate text
  </action>
  <verify>User types "approved" or describes issues found.</verify>
  <done>User has confirmed that the Browse Templates card appears correctly, the marketplace dialog opens on click, template install creates and activates a bot, and the wizard closes cleanly.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with no errors in frontend/
- `WizardMethod` type unchanged in creation.ts
- "Browse Templates" card visible in MethodSelectStep
- Clicking it opens MarketplaceBrowser (not a wizard step)
- Full install flow works: browse → select → install → wizard closes → bot active
- Mini-preview section preserved below method cards
</verification>

<success_criteria>
The bot creation wizard presents "Browse Templates" as a first-class method card. Users can click it to access the full marketplace browser with categories, search, and previews (MKTB-01). One-click template installation creates and activates a new bot (MKTB-02). The option sits alongside "AI Assisted" and "Blank" in the creation flow (MKTB-03).
</success_criteria>

<output>
After completion, create `.planning/phases/02-bot-marketplace/02-01-SUMMARY.md`
</output>
